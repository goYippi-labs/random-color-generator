<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Random Color | goYippi labs</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <style type="text/css">
          @font-face {
            font-family: 'Source Sans Pro';
            font-style: normal;
            font-weight: 400;
            src: url('https://www.goyippi.net/wp-content/themes/goyippi/fonts/source-sans-pro/source-sans-pro-v11-latin-ext_latin-regular.eot'); /* IE9 Compat Modes */
            src: local('Source Sans Pro Regular'), local('SourceSansPro-Regular'),
                 url('https://www.goyippi.net/wp-content/themes/goyippi/fonts/source-sans-pro/source-sans-pro-v11-latin-ext_latin-regular.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
                 url('https://www.goyippi.net/wp-content/themes/goyippi/fonts/source-sans-pro/source-sans-pro-v11-latin-ext_latin-regular.woff2') format('woff2'), /* Super Modern Browsers */
                 url('https://www.goyippi.net/wp-content/themes/goyippi/fonts/source-sans-pro/source-sans-pro-v11-latin-ext_latin-regular.woff') format('woff'), /* Modern Browsers */
                 url('https://www.goyippi.net/wp-content/themes/goyippi/fonts/source-sans-pro/source-sans-pro-v11-latin-ext_latin-regular.ttf') format('truetype'), /* Safari, Android, iOS */
                 url('https://www.goyippi.net/wp-content/themes/goyippi/fonts/source-sans-pro/source-sans-pro-v11-latin-ext_latin-regular.svg#SourceSansPro') format('svg'); /* Legacy iOS */
          }
    			html, body {
    				width: 100%;
    				height: 100%;
    			}
          body {
                font-family: 'Source Sans Pro', Arial, sans-serif;
                font-size: 1.063em;
                line-height: 1.5;
                color: #000;
                margin: 0;
                padding: 0;
				        position: relative;
            }
			ul#sortable {
				list-style: none;
				margin: 0;
				padding: 0;
				width: 100%;
				height: 100%;
			}

			ul#sortable li {
				margin: 0;
				padding: 0;
			}
			.color-box {
				width: 100%;
				height: 100%;
				float: left;
				position: relative;
				transition: background-color 0.25s;
			}
			.color-box:hover {
				cursor: move;
			}
            .input-box {
                max-width: 280px;
                margin: 0 auto;
                background-color: #fff;
            }
			.color-7 .input-box {
				font-size: 0.6em;
			}
			.color-10 .input-box {
				display: none;
			}
            .input-box-inner {
                padding: 20px;
            }
            button {
                font-family: 'Source Sans Pro', Arial, sans-serif;
                font-size: 1.063em;
                border: 0;
				color: #000;
                background-color: #d8d8d8;
                width: 99%;
                padding: 3px 1px;
                border-radius: 0;
                margin-bottom: 6px;
				cursor: pointer;
            }
            .output {
                display: inline-block !important;
                margin-right: 10px;
            }
			.output-rgb {
                margin-right: 0;
            }
			.download-box, .add-box, .remove-box {
				position: absolute;
				left: 0;
				top: 50%;
				margin-top: -20px;
				width: 100%;
			}
			.add-box, .remove-box, .download-box .save {
				font-family: 'Material Icons';
				font-size: 24px;
				cursor: pointer;
				padding: 10px;
				font-size: 2em;
				line-height: 1;
				background-color: #FFF;
				line-height: 20px;
				width: 20px;
				height: 20px;
				display: inline-block;
				text-indent: -6px;
				text-align: center;
				outline: none;
				overflow: hidden;
			}
			.add-box {
				left: auto;
				right: 0;
			}
			.download {
				visibility: hidden;
			}
			.download-box {
				top: auto;
				left: auto;
				right: 0;
				bottom: 60px;
				margin-top: 0;
				width: 40px;
				overflow: hidden;
			}
			.download-box .save {
				color: #000;
				text-decoration: none;
				top: 0;
				right: 0;
			}
			@media screen and (min-width: 601px) {
				.color-3 .input-box {
					max-width: 100px;
				}
				.color-3 .output-rgb {
					display: none !important;
				}
				.color-3 .output-label {
					display: none;
				}
			}
			@media screen and (max-width: 600px) , screen and (orientation: portrait) {
				.color-3 .input-box-inner {
                	padding: 10px 20px;
            	}
				.color-box {
					width: 100%;
					float: none;
					min-height: 80px;
				}
				.color-7 .color-box {
					min-height: 60px;
				}
				.color-10 .color-box {
					min-height: 0;
				}
				.add-box {
					top: auto;
					bottom: 0;
					margin-top: 0;
				}
				.remove-box {
					top: 0;
					margin-top: 0;
				}
			}
			@media screen and (max-width: 400px) {
				.input-box {
					max-width: 100px;
				}
				.output-rgb {
					display: none !important;
				}
				.output-label {
					display: none;
				}
			}
        </style>
    </head>
    <body class="color-1">
		<ul id="sortable">
			<li id="box-1" class="color-box">
				<div class="input-box">
					<div class="input-box-inner">
						<div class="input">
							<button class="reload">Reload</button>
						</div>
						<div class="output output-hex"></div>
						<div class="output output-rgb"></div>
					</div>
				</div>
			</li>
		</ul>

		<div class="download-box">
			<textarea class="download"></textarea>
			<a href="#" class="save">&#xE2C4;</a>
		</div>

		<div class="add-box add">&#xE145;</div>

		<script src="https://cdn.jsdelivr.net/gh/jquery/jquery@1.12.4/dist/jquery.min.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/sortablejs@1.6.1/Sortable.min.js"></script>
        <script type="text/javascript">
			var maxItems = 8;
			var windowWidth = jQuery(window).width();
			var download = document.querySelector('textarea.download');
			var download_link = document.querySelector('.save');

           	var randomColor = function(str) {
                var chars = ['0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f'];
				var color = '';

				for(var i = 0; i < 6; i++) {
					color += chars[Math.floor(Math.random()*chars.length)];
				}

				return color;
            }

            // Pluto's comment: http://stackoverflow.com/questions/5623838/rgb-to-hex-and-hex-to-rgb
            var hexToRgb = function(hex) {
                return [(bigint = parseInt(hex, 16)) >> 16 & 255, bigint >> 8 & 255, bigint & 255].join();
            }

            var colorOutput = function(color, id) {
				$('#box-' + id).css('background-color', '#' + color);
                $('#box-' + id + ' .output-hex').show().empty().append( '<span class="output-label">HEX: </span>#' + color );
                $('#box-' + id + ' .output-rgb').show().empty().append( '<span class="output-label">RGB: </span>' + hexToRgb(color) );
            }

			var addBox = function() {
				$('.color-box:last').clone().removeAttr('id').insertAfter('.color-box:last').attr( 'id', 'box-' + $('.color-box').length );
				$('body').addClass('color-' + $('.color-box').length);
				boxWidth();
				colorOutput( randomColor(), $('.color-box').length );
				checkBox();
			}

			var removeBox = function(id) {
				var length = $('.color-box').length;

				$('#box-' + id).remove();
				$('body').removeClass('color-' + length);
				boxWidth();
				checkBox();
            }

			var boxWidth = function() {
				if (window.innerHeight > window.innerWidth || window.innerWidth <= 600) {
		   			$('.color-box').css({'width' : '100%', 'height' : 100/$('.color-box').length + '%'});
				} else {
		   			$('.color-box').css({'width' : 100/$('.color-box').length + '%', 'height' : '100%'});
				}
			}

			var checkBox = function() {
				$('.color-box').each(function(index, element) {
					$(this).removeAttr('id').attr( 'id', 'box-' + (index + 1) );
				});

				if ($('.color-box').length == 1) {
					$('.color-box .remove-box').remove();
				} else if ($('.color-box').length == 2) {
					$('.color-box').append('<div class="remove-box remove">&#xE15B;</div>');
				}

				if ($('.color-box').length >= maxItems) {
					$('body .add-box').remove();
				} else if ($('.add-box').length == 0) {
					$('body').append('<div class="add-box add">&#xE145;</div>');
				}
			}

            jQuery(document).ready(function($) {
				var el = document.getElementById('sortable');
				var sortable = new Sortable(el, {
					onEnd: function () {
						checkBox();
					}
				});

				colorOutput( randomColor(), 1 );

				// Leo's comment: http://stackoverflow.com/questions/27398074/saving-a-data-from-html-form-to-text-file-with-jquery-javascript
				download_link.onclick = function() {
					$('textarea.download').empty();

					$('.color-box').each(function(index) {
						$('textarea.download').append('Color ' + (index + 1) + ' ' + $(this).find('.output-hex').text() + ' ' + $(this).find('.output-rgb').text() + ';\n');
					});

    				download_link.href = 'data:text/plain;charset=utf-8,' + encodeURIComponent(download.value);
    				download_link.download = 'your-colors.txt';
				};

				$(window).resize(function(e) {
					if ($(window).width() != windowWidth) {
						boxWidth();
					}
				});

				$(window).on("orientationchange",function(){
					boxWidth();
				});
            });

			jQuery(document).on('click', '.reload', function() {
				colorOutput( randomColor(), $('.color-box').index($(this).closest( '.color-box' ))+1 );
			});

			jQuery(document).on('click', '.add', function() {
				addBox();
			});

			jQuery(document).on('click', '.remove', function() {
				removeBox( $('.color-box').index($(this).closest( '.color-box' ))+1 );
			});
        </script>
		</body>
</html>
